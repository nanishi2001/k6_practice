# Skills vs Agents: Token効率ガイド

## 概要

Claude Codeでは**Skills**と**Agents**の2つの拡張機能があり、用途に応じて使い分けることでtoken効率を最適化できます。

## 比較表

| 特性 | Skills | Agents (Task tool) |
|------|--------|-------------------|
| コンテキスト | 現在の会話に**追加** | **別プロセス**で実行 |
| Token消費 | メインコンテキストを消費 | 結果のみ返却（要約） |
| 適切な用途 | 軽量・単発タスク | 複雑・多段階タスク |
| 会話履歴 | 参照可能 | 参照不可（独立） |
| 起動コスト | 低い | やや高い |

## 使い分けの原則

### Skills を使う場合（token効率: 高）

```
軽量タスク（1-2ステップ）で、会話コンテキストが必要な場合
```

- クイックコマンド（コミット、PR作成）
- 定型作業のショートカット
- 現在の会話内容を参照する必要がある場合

**例**: `/commit`, `/k6-run`

### Agents を使う場合（token効率: 高）

```
複雑なタスク（3+ステップ）で、多くのファイル探索が必要な場合
```

- コードベースの探索・調査
- 複数ファイルにまたがる分析
- 実装計画の作成
- テストレビュー

**例**: `planner`, `k6-reviewer`, `Explore`

## アンチパターン（token効率: 低）

### ❌ 避けるべきパターン

1. **単純なタスクにAgentを使用**
   - 1ファイルの読み取りにAgentを起動 → 直接Readツールを使う

2. **複雑な探索にSkillを使用**
   - 大量のファイル検索をSkillで実行 → Agentに委譲

3. **Agentの結果を再度Agentに渡す**
   - コンテキストが失われる → 1つのAgentで完結させる

### ✅ 推奨パターン

1. **単発コマンド → Skill**
   ```
   /k6-run load  # すぐ実行
   ```

2. **調査・分析 → Agent**
   ```
   Task(Explore): "エラーハンドリングのパターンを調査"
   ```

3. **計画が必要 → Agent (planner)**
   ```
   Task(planner): "新しいテストシナリオの実装計画"
   ```

## Token消費の目安

| 操作 | 推定Token | 推奨 |
|------|----------|------|
| Skill呼び出し | 500-1500 | 軽量タスク |
| Agent起動 | 2000-5000 | 複雑タスク |
| 直接ツール使用 | 100-500 | 単純操作 |

## 判断フローチャート

```
タスクを受け取る
    │
    ├─ 1-2ステップで完了？
    │   ├─ Yes → 会話コンテキスト必要？
    │   │         ├─ Yes → Skill
    │   │         └─ No  → 直接ツール
    │   │
    │   └─ No → 複数ファイル探索？
    │           ├─ Yes → Agent (Explore/専門)
    │           └─ No  → 直接実行
```
